<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rapport Projet miniGPT</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 210mm;
            margin: 0 auto;
            padding: 20px;
            background: #fff;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            border-bottom: 3px solid #4f46e5;
            padding-bottom: 20px;
        }

        .header h1 {
            color: #4f46e5;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header .subtitle {
            color: #6b7280;
            font-size: 1.2em;
        }

        .toc {
            background: #f8fafc;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }

        .toc h2 {
            color: #374151;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 10px;
        }

        .toc ul {
            list-style: none;
            padding: 0;
        }

        .toc li {
            padding: 8px 0;
            border-bottom: 1px solid #e5e7eb;
        }

        .toc a {
            text-decoration: none;
            color: #4f46e5;
            font-weight: 500;
        }

        .section {
            margin-bottom: 40px;
            page-break-inside: avoid;
        }

        .section h2 {
            color: #1f2937;
            font-size: 1.8em;
            border-bottom: 2px solid #4f46e5;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        .section h3 {
            color: #374151;
            font-size: 1.4em;
            margin-top: 25px;
            margin-bottom: 15px;
        }

        .section h4 {
            color: #4b5563;
            font-size: 1.2em;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .code-tree {
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.85em;
            overflow-x: auto;
            margin: 15px 0;
            line-height: 1.4;
        }

        .code-tree .folder {
            color: #fbbf24;
            font-weight: bold;
        }

        .code-tree .file {
            color: #93c5fd;
        }

        .code-tree .comment {
            color: #6b7280;
            font-style: italic;
        }

        .architecture-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin: 25px 0;
        }

        .arch-card {
            background: #ffffff;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .arch-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.15);
        }

        .arch-card h4 {
            color: #4f46e5;
            margin-top: 0;
            font-size: 1.3em;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 10px;
        }

        .arch-card .description {
            color: #6b7280;
            font-size: 0.95em;
            margin-bottom: 15px;
            font-style: italic;
        }

        .layer-section {
            margin-bottom: 30px;
            background: #f8fafc;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #4f46e5;
        }

        .layer-title {
            color: #1f2937;
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .layer-icon {
            margin-right: 10px;
            font-size: 1.5em;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            border: 1px solid #e5e7eb;
            padding: 12px;
            text-align: left;
        }

        th {
            background: #f9fafb;
            font-weight: 600;
            color: #374151;
        }

        .highlight {
            background: #fef3c7;
            padding: 15px;
            border-left: 4px solid #f59e0b;
            border-radius: 0 8px 8px 0;
            margin: 15px 0;
        }

        .info-box {
            background: #eff6ff;
            padding: 15px;
            border-left: 4px solid #3b82f6;
            border-radius: 0 8px 8px 0;
            margin: 15px 0;
        }

        @media print {
            body { margin: 0; }
            .section { page-break-inside: avoid; }
            .header { page-break-after: avoid; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Rapport de Projet</h1>
        <div class="subtitle">miniGPT - Assistant Conversationnel Intelligent</div>
        <p style="margin-top: 20px; color: #6b7280;">
            Date de génération : <strong id="current-date"></strong><br>
            Version du projet : <strong>1.0</strong>
        </p>
    </div>

    <div class="toc">
        <h2>Table des Matières</h2>
        <ul>
            <li><a href="#introduction">1. Introduction</a></li>
            <li><a href="#architecture">2. Architecture et Conception</a>
                <ul style="margin-left: 20px; list-style: disc;">
                    <li><a href="#bdd">2.1 Base de données</a></li>
                    <li><a href="#archi-logicielle">2.2 Architecture logicielle</a></li>
                </ul>
            </li>
            <li><a href="#fonctionnalites">3. Fonctionnalités développées</a></li>
            <li><a href="#difficultes">4. Difficultés et Solutions</a></li>
            <li><a href="#outils-ia">5. Utilisation des outils IA</a></li>
            <li><a href="#conclusion">6. Conclusion</a></li>
        </ul>
    </div>

    <div class="section" id="introduction">
        <h2>1. Introduction</h2>

        <h3>Contexte et objectifs</h3>
        <p>Le projet <strong>miniGPT</strong> est une application web moderne développée pour offrir une interface utilisateur intuitive et performante pour interagir avec des modèles d'intelligence artificielle conversationnelle.</p>

        <div class="highlight">
            <strong>Objectifs principaux :</strong>
            <ul>
                <li>Créer une interface de chat moderne et responsive</li>
                <li>Intégrer plusieurs modèles d'IA (via OpenRouter)</li>
                <li>Gérer des conversations persistantes</li>
                <li>Permettre la personnalisation des instructions utilisateur</li>
                <li>Assurer la sécurité et l'authentification</li>
            </ul>
        </div>

        <h3>Technologies utilisées</h3>
        <table>
            <tr>
                <th>Couche</th>
                <th>Technologies</th>
                <th>Version</th>
            </tr>
            <tr>
                <td><strong>Backend</strong></td>
                <td>PHP, Laravel, Jetstream, Sanctum</td>
                <td>8.2+, 12.0, 5.3, 4.0</td>
            </tr>
            <tr>
                <td><strong>Frontend</strong></td>
                <td>Vue.js, Vite, Tailwind CSS, Inertia.js</td>
                <td>3.3, 6.2, 3.4, 2.0</td>
            </tr>
            <tr>
                <td><strong>IA</strong></td>
                <td>OpenRouter API, OpenAI PHP Client</td>
                <td>-, 0.13</td>
            </tr>
            <tr>
                <td><strong>Tests</strong></td>
                <td>Pest PHP, Laravel Pint</td>
                <td>3.8, 1.13</td>
            </tr>
        </table>
    </div>

    <div class="section" id="architecture">
        <h2>2. Architecture et Conception</h2>

        <div id="bdd">
            <h3>2.1 Base de données</h3>

            <h4>Diagramme UML</h4>
            <div class="code-tree">
┌─────────────────────────────────────────────────────────────┐
│                    DIAGRAMME ENTITÉ-RELATION                │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  USERS (Utilisateurs)              CONVERSATIONS            │
│  ├─ id (PK)                       ├─ id (PK)                │
│  ├─ name                          ├─ user_id (FK)           │
│  ├─ email (UK)                    ├─ title                  │
│  ├─ password                      ├─ model                  │
│  ├─ preferred_model               └─ timestamps             │
│  ├─ two_factor_secret                      │                │
│  └─ timestamps                             │                │
│           │                               │                │
│           │ (1:N)                         │ (1:N)          │
│           │                               │                │
│           ▼                               ▼                │
│  USER_INSTRUCTIONS              MESSAGES                    │
│  ├─ id (PK)                     ├─ id (PK)                 │
│  ├─ user_id (FK)                ├─ conversation_id (FK)    │
│  ├─ type                        ├─ user_id (FK, nullable)  │
│  ├─ title                       ├─ role (user|assistant)   │
│  ├─ content                     ├─ content (JSON)          │
│  ├─ is_active                   └─ timestamps              │
│  ├─ order                                                  │
│  └─ timestamps                                             │
└─────────────────────────────────────────────────────────────┘
            </div>

            <h4>Relations principales</h4>
            <ul>
                <li><strong>users</strong> → <strong>conversations</strong> (1:N) : Un utilisateur peut avoir plusieurs conversations</li>
                <li><strong>users</strong> → <strong>user_instructions</strong> (1:N) : Instructions personnalisées par utilisateur</li>
                <li><strong>conversations</strong> → <strong>messages</strong> (1:N) : Chaque conversation contient plusieurs messages</li>
            </ul>
        </div>

        <div id="archi-logicielle">
            <h3>2.2 Architecture logicielle</h3>

            <div class="info-box">
                <strong>🏗️ Architecture Modern Stack :</strong> Laravel 12 + Vue.js 3 + Inertia.js pour une expérience SPA fluide avec la robustesse du MVC côté serveur.
            </div>

            <div class="layer-section">
                <div class="layer-title">
                    <span class="layer-icon">🔧</span>
                    Organisation du code Laravel - Structure MVC
                </div>

                <div class="architecture-grid">
                    <div class="arch-card">
                        <h4>📁 Controllers (Contrôleurs)</h4>
                        <div class="description">Gestion des requêtes HTTP et logique de présentation</div>
                        <div class="code-tree">
<span class="folder">app/Http/Controllers/</span>
├── <span class="file">AskController.php</span>
│   <span class="comment">// Gestion page d'accueil chat</span>
│   <span class="comment">// Création nouvelles conversations</span>
├── <span class="file">ConversationController.php</span>
│   <span class="comment">// CRUD complet conversations</span>
│   <span class="comment">// Streaming messages en temps réel</span>
├── <span class="file">ModelController.php</span>
│   <span class="comment">// Sélection/changement modèles IA</span>
└── <span class="file">UserInstructionController.php</span>
    <span class="comment">// Gestion instructions personnalisées</span>
                        </div>
                    </div>

                    <div class="arch-card">
                        <h4>🗄️ Models (Modèles)</h4>
                        <div class="description">Représentation des données et logique métier</div>
                        <div class="code-tree">
<span class="folder">app/Models/</span>
├── <span class="file">User.php</span>
│   <span class="comment">// Authentification 2FA + relations</span>
├── <span class="file">Conversation.php</span>
│   <span class="comment">// Sessions chat + modèle IA utilisé</span>
├── <span class="file">Message.php</span>
│   <span class="comment">// Messages user/assistant + format API</span>
└── <span class="file">UserInstruction.php</span>
    <span class="comment">// Instructions personnalisées actives</span>
                        </div>
                    </div>

                    <div class="arch-card">
                        <h4>🔧 Services</h4>
                        <div class="description">Logique métier complexe et intégrations externes</div>
                        <div class="code-tree">
<span class="folder">app/Services/</span>
└── <span class="file">ChatService.php</span>
    <span class="comment">// ✨ Service principal IA</span>
    <span class="comment">// - Gestion modèles OpenRouter</span>
    <span class="comment">// - Streaming Server-Sent Events</span>
    <span class="comment">// - Prompts système dynamiques</span>
    <span class="comment">// - Gestion erreurs API</span>
                        </div>
                    </div>

                    <div class="arch-card">
                        <h4>🛡️ Middleware & Sécurité</h4>
                        <div class="description">Authentification, autorisations et validation</div>
                        <div class="code-tree">
<span class="folder">app/Http/</span>
├── <span class="folder">Middleware/</span>
│   └── <span class="file">HandleInertiaRequests.php</span>
├── <span class="folder">Requests/</span>
│   └── <span class="file">StoreMessageRequest.php</span>
└── <span class="folder">../Policies/</span>
    └── <span class="file">ConversationPolicy.php</span>
        <span class="comment">// Autorisation accès conversations</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="layer-section">
                <div class="layer-title">
                    <span class="layer-icon">🎨</span>
                    Structure des composants Vue.js - Architecture modulaire
                </div>

                <div class="architecture-grid">
                    <div class="arch-card">
                        <h4>📄 Pages principales</h4>
                        <div class="description">Vues principales de l'application (routes Inertia)</div>
                        <div class="code-tree">
<span class="folder">resources/js/Pages/</span>
├── <span class="folder">Ask/</span>
│   ├── <span class="file">Index.vue</span>
│   │   <span class="comment">// 🏠 Page d'accueil du chat</span>
│   │   <span class="comment">// - Création nouvelle conversation</span>
│   │   <span class="comment">// - Accès instructions utilisateur</span>
│   └── <span class="file">Chat.vue</span>
│       <span class="comment">// 💬 Interface conversation active</span>
│       <span class="comment">// - Messages en streaming temps réel</span>
│       <span class="comment">// - Rendu Markdown + syntaxe</span>
│       <span class="comment">// - Sélection modèles IA</span>
└── <span class="folder">Auth/</span> <span class="comment">// Pages authentification Jetstream</span>
                        </div>
                    </div>

                    <div class="arch-card">
                        <h4>🧩 Composants réutilisables</h4>
                        <div class="description">Éléments UI modulaires et configurables</div>
                        <div class="code-tree">
<span class="folder">resources/js/Components/</span>
├── <span class="file">SidebarConversations.vue</span>
│   <span class="comment">// 📋 Liste conversations utilisateur</span>
├── <span class="file">ChatNavigation.vue</span>
│   <span class="comment">// 🧭 Barre navigation chat</span>
├── <span class="file">UserInstructionsModal.vue</span>
│   <span class="comment">// ⚙️ Modal gestion instructions</span>
├── <span class="folder">Chat/</span>
│   <span class="comment">// Composants spécifiques au chat</span>
└── <span class="comment">// + Composants UI Jetstream</span>
   <span class="comment">// (Boutons, Modales, Formulaires...)</span>
                        </div>
                    </div>

                    <div class="arch-card">
                        <h4>🎛️ State Management</h4>
                        <div class="description">Gestion des états et données réactives</div>
                        <div class="code-tree">
<span class="comment">🔄 Stratégie de gestion d'état :</span>

• <strong>Props Inertia</strong> : Données serveur → composants
• <strong>Reactive refs</strong> : État local des composants
• <strong>Composables</strong> : Logique réutilisable
• <strong>Event Bus</strong> : Communication inter-composants

<span class="comment">📡 Streaming temps réel :</span>
• <strong>Server-Sent Events</strong> via Fetch API
• <strong>Réactivité Vue.js</strong> pour mise à jour UI
• <strong>Gestion d'erreurs</strong> avec reconnexion auto
                        </div>
                    </div>

                    <div class="arch-card">
                        <h4>🎨 Styling & UI</h4>
                        <div class="description">Design system et architecture CSS</div>
                        <div class="code-tree">
<span class="folder">resources/</span>
├── <span class="folder">css/</span>
│   └── <span class="file">app.css</span> <span class="comment">// Styles Tailwind + custom</span>
└── <span class="folder">js/</span>
    ├── <span class="file">app.js</span> <span class="comment">// Point d'entrée Vue/Inertia</span>
    └── <span class="file">bootstrap.js</span> <span class="comment">// Config Axios + intercepteurs</span>

<span class="comment">🎨 Architecture CSS :</span>
• <strong>Tailwind CSS</strong> : Classes utilitaires
• <strong>Composants styled</strong> : Réutilisables
• <strong>Responsive design</strong> : Mobile-first
• <strong>Dark mode ready</strong> : Variables CSS
                        </div>
                    </div>
                </div>
            </div>

            <h4>🔄 Flow de données et communication</h4>
            <div class="code-tree">
┌─────────────────────────────────────────────────────────────────────────────┐
│                              FLUX DE DONNÉES                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  1. USER INTERACTION                                                        │
│     Vue Component → User Input → Form Submission                           │
│                                                                             │
│  2. HTTP REQUEST                                                            │
│     Inertia/Axios → Laravel Route → Controller → Validation                │
│                                                                             │
│  3. BUSINESS LOGIC                                                          │
│     Controller → Service (ChatService) → External API (OpenRouter)         │
│                                                                             │
│  4. DATA PERSISTENCE                                                        │
│     Service → Eloquent Models → Database → Relations Update                │
│                                                                             │
│  5. RESPONSE STREAMING                                                      │
│     ChatService → StreamResponse → SSE → Vue Component → UI Update         │
│                                                                             │
│  6. STATE MANAGEMENT                                                        │
│     Reactive Data → DOM Update → User Feedback → Next Interaction          │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
            </div>

            <div class="highlight">
                <strong>🚀 Points clés de l'architecture :</strong>
                <ul>
                    <li><strong>Séparation claire des responsabilités</strong> : MVC côté serveur, composants modulaires côté client</li>
                    <li><strong>Communication temps réel</strong> : Server-Sent Events pour le streaming des réponses IA</li>
                    <li><strong>Sécurité robuste</strong> : Authentification 2FA, Policies, validation des données</li>
                    <li><strong>Performance optimisée</strong> : Lazy loading, cache, requêtes optimisées</li>
                    <li><strong>Évolutivité</strong> : Architecture modulaire permettant l'ajout de nouvelles fonctionnalités</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Les autres sections seront ajoutées ici... -->
    <div class="section" id="fonctionnalites">
        <h2>3. Fonctionnalités développées</h2>
        <p><em>Section complète disponible dans la version finale du rapport...</em></p>
    </div>

    <div class="section" id="difficultes">
        <h2>4. Difficultés et Solutions</h2>
        <p><em>Section complète disponible dans la version finale du rapport...</em></p>
    </div>

    <div class="section" id="outils-ia">
        <h2>5. Utilisation des outils IA</h2>
        <p><em>Section complète disponible dans la version finale du rapport...</em></p>
    </div>

    <div class="section" id="conclusion">
        <h2>6. Conclusion</h2>
        <p><em>Section complète disponible dans la version finale du rapport...</em></p>
    </div>

    <script>
        // Ajouter la date actuelle
        document.getElementById('current-date').textContent = new Date().toLocaleDateString('fr-FR', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });
    </script>
</body>
</html>
